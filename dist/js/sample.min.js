"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),e}var Loader=function(){function e(){_classCallCheck(this,e),this.container=document.querySelector("#loader"),this.grey=this.container.querySelector(".grey"),this.white=this.container.querySelector(".white"),this.textWrap=this.container.querySelector(".text-wrap"),this.text=this.container.querySelector(".text"),this.dot=this.text.querySelector("span"),this.animateDot()}return _createClass(e,[{key:"animateDot",value:function(){this.dotTween=TweenMax.fromTo(this.dot,.5,{y:0},{y:-10,ease:"Power0.easeOut",yoyo:!0,yoyoEase:"Bounce.easeOut",repeat:-1,repeatDelay:.3})}},{key:"hide",value:function(){var e=this;new TimelineMax({delay:.5,onComplete:function(){e.dotTween.kill(),e.container.style.display="none"}}).to(this.text,.8,{y:100,ease:"Expo.easeIn"},0).to(this.grey,1,{yPercent:100,ease:"Expo.easeOut"},.8).to(this.white,1,{yPercent:100,ease:"Expo.easeOut"},1).fromTo("#slider-canvas",1,{scale:1.1},{scale:1,ease:"Expo.easeOut"},1)}}]),e}(),Slider=function(){function i(e,t){_classCallCheck(this,i),this.canvas=e,this.loader=t,this.setOptions(),this.createApp(),this.loadImages()}return _createClass(i,[{key:"setOptions",value:function(){PIXI.utils.skipHello(),PIXI.settings.SCALE_MODE=PIXI.SCALE_MODES.LINEAR,PIXI.settings.PRECISION_FRAGMENT=PIXI.PRECISION.HIGH,this.canvasWidth=this.canvas.clientWidth,this.canvasHeight=this.canvas.clientHeight,this.dpr=window.devicePixelRatio&&2<=window.devicePixelRatio?2:1,this.thumbsVisible=!1,this.animating=!1,this.dom={titleNext:document.querySelector(".slide-title .next"),titleCurrent:document.querySelector(".slide-title .current"),descriptionNext:document.querySelector(".description .next"),descriptionCurrent:document.querySelector(".description .current"),countNext:document.querySelector(".slide-count .next"),countCurrent:document.querySelector(".slide-count .current")},this.slideData={0:{image:"https://s3-us-west-2.amazonaws.com/s.cdpn.io/123024/j110.jpg",title:"J110",description:"With the comfort of a lounge chair and the functionality of a dining chair, HAY’s reproduction of Poul M. Voulter’s J110 offers equal measures of strong aesthetics and practicality. Long rods at the back and curved armrests create an inviting expression. Made in lacquered solid beech and available in a variety of colours."},1:{image:"https://s3-us-west-2.amazonaws.com/s.cdpn.io/123024/j104.jpg",title:"J104",description:"Jørgen Bækmark’s J104 chair was designed as a cross between a dining chair and an easy chair, HAY’s reproduction of this classic is crafted in solid beech with a variety of soaped or lacquered finishes."},2:{image:"https://s3-us-west-2.amazonaws.com/s.cdpn.io/123024/j42.jpg",title:"J42",description:"HAY’s reproduction of Børge Mogensen’s classic J42 chair clearly reflects his design philosophy. Precise proportions with simple horizontal and vertical lines are used to construct a curved spindled backrest and angular armrests. With a broad plywood seat and frame in solid oak or beech, the design has a timeless quality that is built to provide lasting comfort."}}}},{key:"createApp",value:function(){this.app=new PIXI.Application(this.canvasWidth,this.canvasHeight,{view:this.canvas,width:this.canvasWidth,height:this.canvasHeight,transparent:!0,resolution:this.dpr,autoResize:!0})}},{key:"loadImages",value:function(){var i=this;Object.keys(this.slideData).forEach(function(e){PIXI.loader.add(e,i.slideData[e].image)}),PIXI.loader.load(function(e,t){i.images=t,i.createSlider(),i.loader.hide()})}},{key:"createSlider",value:function(){var e=this;this.slider=new PIXI.Container,this.slider.width=this.app.screen.width,this.slider.height=this.app.screen.height,this.app.stage.addChild(this.slider),this.clipRect=new PIXI.Rectangle(0,0,this.app.screen.width,this.app.screen.height),this.slider.filterArea=this.clipRect,this.app.stage.interactive=!0,this.app.stage.on("pointerdown",function(){e.thumbsVisible?e.hideThumbs():e.showThumbs()}),this.addSlides(),this.createDisplacementFilter(),this.buttonEvents()}},{key:"addSlides",value:function(){var t=this;this.slides={activeIndex:0,count:0};var i=0;Object.keys(this.images).forEach(function(e){e=new PIXI.Sprite(t.images[e].texture);e.width=t.app.screen.width,e.height=t.app.screen.height,e.y=0===i?0:-t.app.screen.height,t.slides[i]=e,t.slider.addChild(e),i++,t.slides.count++}),document.querySelector(".slide-count .total").textContent="0".concat(this.slides.count),document.querySelector(".slide-title .code").style.width=this.dom.titleCurrent.scrollWidth+6+"px";for(var e=0;e<this.slides.count;e++)document.querySelector(".dots").innerHTML+="<span></span>";document.querySelector(".dots > span:nth-child(1)").classList.add("active")}},{key:"nextSlide",value:function(){var e=this;if(this.nextBtn.getAttribute("disabled")||this.thumbsVisible||this.animating)return!1;this.prevBtn.removeAttribute("disabled"),this.slides.activeIndex+2>=this.slides.count&&this.nextBtn.setAttribute("disabled","disabled");var t=this.slideData[this.slides.activeIndex+1];this.dom.titleNext.textContent=t.title,this.dom.descriptionNext.textContent=t.description,this.dom.countNext.textContent="0"+(this.slides.activeIndex+2),this.updateDot(!0),new TimelineMax({onStart:function(){e.animating=!0},onComplete:function(){e.slides.activeIndex++,e.resetText(),e.animating=!1}}).to(this.slides[this.slides.activeIndex],2,{y:this.app.screen.height,ease:"Expo.easeInOut"},0).fromTo(this.slides[this.slides.activeIndex+1],2,{y:-this.app.screen.height},{y:0,ease:"Expo.easeInOut"},0).to(this.dispFilter.scale,1,{x:10,y:10,ease:"Power2.easeInOut"},0).to(this.dispFilter.scale,1,{x:0,y:0,ease:"Power2.easeInOut"},1).set(".slide-count .next",{top:"-100%"},0).fromTo([".slide-count .current",".slide-count .next"],2,{yPercent:0},{yPercent:100,ease:"Expo.easeInOut"},0).set(".slide-title .next",{top:"-100%"},0).fromTo([".slide-title .current",".slide-title .next"],2,{yPercent:0},{yPercent:100,ease:"Expo.easeInOut"},0).to(".slide-title .code",2,{width:this.dom.titleNext.scrollWidth+6,ease:"Expo.easeInOut"},0).fromTo(".description .current",2,{y:0,autoAlpha:1},{y:40,autoAlpha:0,ease:"Expo.easeInOut"},0).fromTo(".description .next",2,{y:-40,autoAlpha:0},{y:0,autoAlpha:1,ease:"Expo.easeInOut"},0)}},{key:"prevSlide",value:function(){var e=this;if(this.prevBtn.getAttribute("disabled")||this.thumbsVisible||this.animating)return!1;this.nextBtn.removeAttribute("disabled"),this.slides.activeIndex-2<0&&this.prevBtn.setAttribute("disabled","disabled");var t=this.slideData[this.slides.activeIndex-1];this.dom.titleNext.textContent=t.title,this.dom.descriptionNext.textContent=t.description,this.dom.countNext.textContent="0"+this.slides.activeIndex,this.updateDot(!1),new TimelineMax({onStart:function(){e.animating=!0},onComplete:function(){e.slides.activeIndex--,e.resetText(),e.animating=!1}}).to(this.slides[this.slides.activeIndex],2,{y:-this.app.screen.height,ease:"Expo.easeInOut"},0).fromTo(this.slides[this.slides.activeIndex-1],2,{y:this.app.screen.height},{y:0,ease:"Expo.easeInOut"},0).to(this.dispFilter.scale,1,{x:10,y:10,ease:"Power2.easeInOut"},0).to(this.dispFilter.scale,1,{x:0,y:0,ease:"Power2.easeInOut"},1).set(".slide-count .next",{top:"100%"},0).fromTo([".slide-count .current",".slide-count .next"],2,{yPercent:0},{yPercent:-100,ease:"Expo.easeInOut"},0).set(".slide-title .next",{top:"100%"},0).fromTo([".slide-title .current",".slide-title .next"],2,{yPercent:0},{yPercent:-100,ease:"Expo.easeInOut"},0).to(".slide-title .code",2,{width:this.dom.titleNext.scrollWidth+6,ease:"Expo.easeInOut"},0).fromTo(".description .current",2,{y:0,autoAlpha:1},{y:-40,autoAlpha:0,ease:"Expo.easeInOut"},0).fromTo(".description .next",2,{y:40,autoAlpha:0},{y:0,autoAlpha:1,ease:"Expo.easeInOut"},0)}},{key:"resetText",value:function(){this.dom.titleCurrent.textContent=this.dom.titleNext.textContent,this.dom.titleCurrent.removeAttribute("style"),this.dom.titleNext.textContent="",this.dom.titleNext.removeAttribute("style"),this.dom.descriptionCurrent.textContent=this.dom.descriptionNext.textContent,this.dom.descriptionCurrent.removeAttribute("style"),this.dom.descriptionNext.textContent="",this.dom.descriptionNext.removeAttribute("style"),this.dom.countCurrent.textContent=this.dom.countNext.textContent,this.dom.countCurrent.removeAttribute("style"),this.dom.countNext.textContent="",this.dom.countNext.removeAttribute("style")}},{key:"createDisplacementFilter",value:function(){this.dispSprite=PIXI.Sprite.fromImage("https://s3-us-west-2.amazonaws.com/s.cdpn.io/123024/disp5.jpg"),this.dispSprite.texture.baseTexture.wrapMode=PIXI.WRAP_MODES.REPEAT,this.dispSprite.skew.x=1,this.dispSprite.skew.y=-1,this.dispSprite.position.y=380,this.dispSprite.scale.y=1.8,this.dispSprite.scale.x=1.8,this.app.stage.addChild(this.dispSprite),this.dispFilter=new PIXI.filters.DisplacementFilter(this.dispSprite,0),this.slider.filters=[this.dispFilter]}},{key:"buttonEvents",value:function(){var t=this;this.prevBtn=document.querySelector('.slide-nav [data-direction="prev"]'),this.nextBtn=document.querySelector('.slide-nav [data-direction="next"]'),this.prevBtn.addEventListener("click",this.prevSlide.bind(this)),this.nextBtn.addEventListener("click",this.nextSlide.bind(this)),document.onkeydown=function(e){38==(e=e||window.event).keyCode?t.prevSlide.call(t):40==e.keyCode&&t.nextSlide.call(t)}}},{key:"showThumbs",value:function(){this.thumbsVisible=!0,this.canvas.classList.add("thumbs-visible"),this.thumbsTl=new TimelineMax,this.thumbsTl.fromTo(this.clipRect,3,{y:0},{y:this.app.screen.height+50,ease:"Expo.easeInOut"},0).fromTo(this.dispFilter.scale,2,{x:0,y:0},{x:10,y:10,ease:"Expo.easeInOut"},0).fromTo(this.dispSprite,3,{y:this.app.screen.height},{y:0,ease:"Power2.easeInOut"},.5).staggerFromTo(".thumbs > div",3,{height:0},{height:"47%",ease:"Expo.easeInOut"},.1,.2).staggerFromTo(".thumbs > div img",3,{scale:1.4},{scale:1,ease:"Expo.easeInOut"},.1,.2).to(".expand .square",2,{autoAlpha:1,ease:"Expo.easeInOut"},1).to(".expand .grid",2,{autoAlpha:0,ease:"Expo.easeInOut"},1)}},{key:"hideThumbs",value:function(){this.thumbsVisible=!1,this.canvas.classList.remove("thumbs-visible"),this.thumbsTl.reverse()}},{key:"updateDot",value:function(e){e=e?this.slides.activeIndex+2:this.slides.activeIndex;document.querySelector(".dots > span.active").classList.remove("active"),document.querySelector(".dots > span:nth-child(".concat(e,")")).classList.add("active")}}]),i}(),loader=new Loader,slider=new Slider(document.getElementById("slider-canvas"),loader);